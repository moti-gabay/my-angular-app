<div class="event-form-container">
  <h2 class="form-title">
    {{ isEditMode ? 'ערוך אירוע' : 'צור אירוע חדש' }}
  </h2>

  <form (ngSubmit)="onSubmit()" class="form-content">
    <div class="form-group">
      <label for="title" class="form-label">כותרת האירוע:</label>
      <input type="text" id="title" [(ngModel)]="event.title" name="title" required class="form-input">
    </div>

    <div class="form-group">
      <label for="description" class="form-label">תיאור:</label>
      <textarea id="description" [(ngModel)]="event.description" name="description" rows="4"
        class="form-input"></textarea>
    </div>

    <div class="form-group">
      <label for="date" class="form-label">תאריך ושעה:</label>
      <input type="datetime-local" id="date" [(ngModel)]="event.date" name="date" required class="form-input">
    </div>

    <div class="form-group">
      <label for="location" class="form-label">מיקום:</label>
      <input type="text" id="location" [(ngModel)]="event.location" name="location" class="form-input">
    </div>

    <div class="form-checkbox">
      <input type="checkbox" [(ngModel)]="event.is_approved" name="is_approved" class="checkbox-input">
      <label class="form-label">אירוע מאושר (גלוי לכולם)</label>
    </div>

    <button type="submit" class="submit-button">
      {{ isEditMode ? 'שמור שינויים' : 'צור אירוע' }}
    </button>

    <button *ngIf="isEditMode" type="button" (click)="deleteEvent()" class="delete-button">
      מחק אירוע
    </button>
  </form>

  <div *ngIf="message" [ngClass]="messageType === 'success' ? 'message-success' : 'message-error'">
    {{ message }}
  </div>

  <div class="form-footer">
    <a routerLink="/events/admin" class="form-link">חזרה לרשימת ניהול אירועים</a>
  </div>
</div>

<div class="event-list-container">
  <h3 class="list-title">רשימת אירועים לניהול</h3>

  <div *ngIf="loadingEvents" class="loading-text">טוען אירועים...</div>

  <div *ngIf="eventsForAdmin.length > 0" class="event-list">
    <div *ngFor="let ev of eventsForAdmin" class="event-item">
      <div class="event-details">
        <span class="event-title">{{ ev.title }}</span> -
        <span class="event-date">{{ ev.date | date:'short' }}</span>
        <span class="event-status" [ngClass]="ev.is_approved ? 'approved' : 'not-approved'">
          ({{ ev.is_approved ? 'מאושר' : 'לא מאושר' }})
        </span>
      </div>

      <div class="event-actions">
        <a [routerLink]="['/events/admin', ev._id]" class="edit-button">ערוך</a>
        <button *ngIf="ev._id !== undefined" (click)="deleteEventFromList(ev._id!)" class="delete-button-small">
          מחק
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="!loadingEvents && eventsForAdmin.length === 0" class="empty-list">אין אירועים לניהול.</div>

  <div class="form-footer">
    <a routerLink="/events/admin/new" class="create-button">+ צור אירוע חדש</a>
  </div>
</div>