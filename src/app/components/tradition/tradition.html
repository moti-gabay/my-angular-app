<!-- src/app/tradition/tradition.component.html -->
<div class="tradition-container">
  <h2 class="tradition-title">המסורת היהודית</h2>

  <!-- הצגת מצב טעינה -->
  <div *ngIf="loading" class="loading-message">
    <p>טוען פריטי מסורת... אנא המתן.</p>
  </div>

  <!-- הצגת הודעת שגיאה -->
  <div *ngIf="error" class="error-message">
    <p>{{ error }}</p>
    <button (click)="fetchTraditionItems()">נסה שוב</button>
  </div>

  <!-- הצגת המסורת רק כאשר הטעינה הסתיימה ואין שגיאות -->
  <ng-container *ngIf="!loading && !error">
    <!-- הודעה אם אין פריטים להצגה -->
    <div *ngIf="traditionItems.length === 0" class="no-items-message">
      <p>אין פריטי מסורת זמינים כרגע.</p>
    </div>

    <ng-container *ngIf="traditionItems.length > 0">
      <h2>בקצרה... </h2>
      <div class="tradition-summary">
        <div class="text-container">
          <!-- הצגת התיאור הקצר של הפריט הנבחר -->
          <p *ngIf="selectedTraditionItem">{{ selectedTraditionItem.short_description }}</p>
          <p *ngIf="!selectedTraditionItem">בחר נושא מהטאבים למטה כדי ללמוד עליו יותר.</p>
        </div>
        <div class="img-container">
          <!-- הצגת התמונה של הפריט הנבחר -->
          <img class="img-logo" [src]="getFullImageUrl(selectedTraditionItem?.image_url)" 
               [alt]="selectedTraditionItem?.title || 'לוגו המסורת היהודית'"
               onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/333333?text=אין+תמונה';">
        </div>
      </div>

      <div class="tradition-tabs">
        <!-- יצירת כפתורים דינמיים מתוך פריטי המסורת -->
        <button *ngFor="let item of traditionItems" (click)="selectTopic(item.id!)"
          [class.active]="selectedTraditionItem?.id === item.id">
          {{ item.title }}
        </button>
      </div>

      <div class="tradition-content">
        <!-- הצגת הכותרת והתוכן המלא של הפריט הנבחר -->
        <ng-container *ngIf="selectedTraditionItem">
          <h3>{{ selectedTraditionItem.title }}</h3>
          <div [innerHTML]="safeFullContent"></div>
          <p *ngIf="!safeFullContent && selectedTraditionItem.full_content">
            {{ selectedTraditionItem.full_content }}
          </p>
          <p *ngIf="!selectedTraditionItem.full_content">אין תוכן מלא זמין לפריט זה.</p>
          
          <!-- <--- הוספת קישור לכתבה המלאה כאן -->
          <div class="read-more-section">
            <a [routerLink]="['/tradition', selectedTraditionItem.id]" class="read-more-button">
              לכתבה המלאה &rarr;
            </a>
             <a *ngIf="isAdmin" [routerLink]="['/edit-tradition', selectedTraditionItem.id]" class="read-more-button">
              לעריכת הפרסום &rarr;
            </a>
          </div>
        </ng-container>
        <ng-container *ngIf="!selectedTraditionItem">
          <p>בחר נושא מהטאבים למעלה כדי לראות את התוכן המלא.</p>
        </ng-container>
      </div>
    </ng-container>
  </ng-container>
</div>
